<!DOCTYPE html>
<html>

	<!-- credit: the base css is based off of this codepen project and has been modified: http://codepen.io/thanhrossi/pen/PwYROX -->
	
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0-beta1/jquery.min.js"></script>
	<link rel="stylesheet" type="text/css" href="style.css">

	<body>

		<div class="page-left">
			<div id="container">
				<div id="nokia1280">

					<div class="manhinh">
						<div class="mh-wrap">
							<h2>Phone</h2>
							<div class="manchinh">

								<h6 id="inp-txt" style="display:none">
								</h6>

								<h6 class="response" id="cb-res-txt">
								</h6>
								
								<h6 id="del-icon" style="display:none">
									Delete
								</h6>
								<h6 id="send-icon" class="response" style="display:none">
									Send
								</h6>

								<h6 id="reply-icon" class="response">
									Reply
								</h6>


							</div>
						</div> 
					</div>

					<div class="keypad">

						<a href="#" class="small button right" id="back_btn">__</a>
						<a href="#" class="small button left" id="rep_sub_btn">__</a>
						<a href="#" class="big button"></a>

						<span></span>
						
						<a href="#" class="small button call">
							<div class="call-icon"></div>
						</a>
						
						<a href="#" class="small button end">
							<div class="end-icon"></div><div class="end-icon1"></div>
						</a>

						<div class="button-top-buffer"></div>
						
						<div id="key-array">
							<a href="#" id="1" class="average button">1</a>
							<a href="#" id="2abc" class="average button">2abc</a>
							<a href="#" id="def3" class="average button">def3</a>
							<a href="#" id="4ghi" class="average button">4ghi</a>
							<a href="#" id="5jkl" class="average button">5jkl</a>
							<a href="#" id="mno6" class="average button">mno6</a>
							<a href="#" id="7pqrs" class="average button">7pqrs</a>
							<a href="#" id="8tvu" class="average button">8tvu</a>
							<a href="#" id="wxyz9" class="average button">wxyz9</a>
							<a href="#" id="*" class="average button btm-lft-btn">*</a>
							<a href="#" id="0" class="average button">0</a>
							<a href="#" id="#" class="average button btm-rht-btn">#</a>
						</div>

						<div class="mic"></div>

					</div>
				</div>
			</div>
		</div>

		<div class="page-right">
			<center>
				<p id="cb-res-txt-right">
				</p>
			</center>
		</div>

	</body>
	<script type="text/javascript">
		// prototype modifications
		NodeList.prototype.forEach = Array.prototype.forEach;

		// globals
		var g = {};
		g.responding = false;
		g.curr_res = "";


		// utilities
		function adjust () {
			var h = Math.round(($(window).height() - $("#container").height())/2.0);
			if (h > 0) {
				$("#container").css("margin-top", h);
			}
			$(".page-right").height($(window).height());
		}

		function newSMS (text) {
			$("#cb-res-txt").text(text);
			$("#cb-res-txt-right").text(text);
		};

		function clickButton (btn, ct) {
			if (ct > 0) {
				btn.style.background = "rgba(35,140,173, 0.5)"; 
				setTimeout(function () {
					btn.style.background = ""; 
					ct = ct - 1;
					setTimeout(function () {
						clickButton(btn, ct);
					}, 75);
				}, 75);
			}
		};

		function animateKeypress (c) {
			$("#key-array")[0].childNodes.forEach(function (ea)  {
				try {
					if (ea.text !== undefined) {
						var t = ea.text;
						if (t.indexOf(c) > -1) {
							var clickCount = t.indexOf(c) + 1;
							clickButton(ea, clickCount);
						}
					}
				}
				catch (e) {
					// do nothing
					console.log("there was an error", e);
				}
			});
		};


		// initial set up actions
		adjust();
		newSMS('Welcome to CourtSMS. Txt "Y" to continue. Txt "N" to stop receiving txts.');


		// bindings
		$(".button").mousedown(function () {
			this.style.background = "rgba(35,140,173, 0.5)"; 
		});
		$(".button").mouseup(
			function () { this.style.background = "";
		});

		$("body").keypress(function (e) {
			if (g.responding) {
				var c = String.fromCharCode(e.which);
				animateKeypress(c);
				// try to handle deletes
				if (e.charCode == 13) {
					g.curr_res = g.curr_res.slice(0, -1);
				} else {
					g.curr_res += c;
				}
				$("#inp-txt")[0].innerText = g.curr_res;
			}
		});

		$("#rep_sub_btn").click(function () {
			if (g.responding) {
				$("#reply-icon").show();
				$("#cb-res-txt").show();

				$("#inp-txt").hide();
				$("#del-icon").hide();
				$("#send-icon").hide();
			} else {
				$("#reply-icon").hide();
				$("#cb-res-txt").hide();

				$("#inp-txt").show();
				$("#del-icon").show();
				$("#send-icon").show();
			}
			g.responding = !g.responding;
			g.curr_res = "";
		});

		$("#back_btn").click(function () {
			g.curr_res = g.curr_res.slice(0, -1);
			$("#inp-txt")[0].innerText = g.curr_res;
		});

	</script>
</html>
